# 数据分析智能体接口文档

## 查发生不合格问题次数最多的问题

### 基本信息
- **接口名称**：查发生不合格问题次数最多的问题
- **请求方式**：POST
- **请求地址**：`/aiAgent/actions/queryPatrolAgentMostQuestion`
- **所属分组**：数据分析智能体工具接口
- **服务版本**：V2.0.0

### 请求参数

| 参数 | 类型 | 是否必须 | 描述 |
|------|------|----------|------|
| offLine | number | 否 | 线上、线下 |
| startTime | number | 是 | 开始时间戳，毫秒数 |
| endTime | number | 是 | 结束时间戳，毫秒数 |

### 响应参数

| 参数 | 类型 | 是否必须 | 描述 |
|------|------|----------|------|
| code | number | 是 | 消息码，默认0 |
| success | boolean | 是 | 是否正常返回，默认true |
| message | string | 是 | 提示信息，主要用于开发调试 |
| data | object | 是 | 返回包体 |
| data.questionId | string | 否 | 问题ID |
| data.questionName | string | 否 | 问题名称 |

### 响应示例

```json
{
  "code": 0,
  "success": true,
  "message": "操作成功",
  "data": {
    "questionId": "123456",
    "questionName": "员工着装不规范"
  }
}
```

---

## topN问题概览

### 基本信息
- **接口名称**：topN问题概览
- **请求方式**：POST
- **请求地址**：`/aiAgent/actions/queryPatrolAgentStoreQuestionData`
- **所属分组**：数据分析智能体工具接口
- **服务版本**：V2.0.0

### 请求参数

| 参数 | 类型 | 是否必须 | 描述 |
|------|------|----------|------|
| startTime | number | 是 | 开始时间戳，毫秒数 |
| endTime | number | 是 | 结束时间戳，毫秒数 |

### 响应参数

| 参数 | 类型 | 是否必须 | 描述 |
|------|------|----------|------|
| code | number | 是 | 消息码，默认0 |
| success | boolean | 是 | 是否正常返回，默认true |
| message | string | 是 | 提示信息，主要用于开发调试 |
| data | array[object] | 是 | 返回包体 |
| data.storeId | string | 否 | 门店ID |
| data.storeName | string | 否 | 门店名称 |
| data.questionData | array[object] | 否 | topN问题概览 |
| data.questionData[].questionId | string | 否 | 问题ID |
| data.questionData[].questionName | string | 否 | 问题名称 |
| data.questionData[].questionCount | number | 否 | 发生次数 |

### 响应示例

```json
{
  "code": 0,
  "success": true,
  "message": "操作成功",
  "data": [
    {
      "storeId": "1001",
      "storeName": "北京朝阳店",
      "questionData": [
        {
          "questionId": "123456",
          "questionName": "员工着装不规范",
          "questionCount": 15
        },
        {
          "questionId": "123457",
          "questionName": "卫生清洁不到位",
          "questionCount": 10
        }
      ]
    }
  ]
}
```

---

## 查看topN问题图片

### 基本信息
- **接口名称**：查看topN问题图片
- **请求方式**：POST
- **请求地址**：`/aiAgent/actions/queryPatrolAgentStoreQuestionPics`
- **所属分组**：数据分析智能体工具接口
- **服务版本**：V2.0.0

### 请求参数

| 参数 | 类型 | 是否必须 | 描述 |
|------|------|----------|------|
| startTime | number | 是 | 开始时间戳，毫秒数 |
| endTime | number | 是 | 结束时间戳，毫秒数 |
| questionIds | array[string] | 是 | 问题项ID（s） |
| storeId | string | 是 | 门店ID |

### 响应参数

| 参数 | 类型 | 是否必须 | 描述 |
|------|------|----------|------|
| code | number | 是 | 消息码，默认0 |
| success | boolean | 是 | 是否正常返回，默认true |
| message | string | 是 | 提示信息，主要用于开发调试 |
| data | array[object] | 是 | 返回包体 |
| data.questionId | string | 否 | 问题项ID |
| data.pics | array[object] | 否 | 图片列表 |
| data.pics[].picUrl | string | 否 | 图片URL |
| data.pics[].picOrder | number | 否 | 图片顺序编号 |
| data.pics[].captureTime | number | 否 | 图片时间 |
| data.pics[].recordTime | number | 否 | 图片所属考评/点检时间 |
| data.pics[].sourceType | number | 否 | 图片类型，0抓图，1拍照 |
| data.pics[].channelId | string | 否 | 通道ID |
| data.pics[].channelName | string | 否 | 通道名称 |
| data.pics[].patrolId | string | 否 | 考评/点检ID |
| data.pics[].picCoordinate | string | 否 | 涂鸦信息 |
| data.pics[].aiPicCoordinate | string | 否 | ai分析框 |
| data.pics[].multiAnalysisAreaPolygon | string | 否 | 区域框 |

### 响应示例

```json
{
  "code": 0,
  "success": true,
  "message": "操作成功",
  "data": [
    {
      "questionId": "123456",
      "pics": [
        {
          "picUrl": "https://example.com/image1.jpg",
          "picOrder": 1,
          "captureTime": 1705094400000,
          "recordTime": 1705094400000,
          "sourceType": 0,
          "channelId": "ch001",
          "channelName": "摄像头1",
          "patrolId": "patrol001",
          "picCoordinate": "[[100,100],[200,200]]",
          "aiPicCoordinate": "[[110,110],[190,190]]",
          "multiAnalysisAreaPolygon": "[[100,100],[200,100],[200,200],[100,200]]"
        }
      ]
    }
  ]
}
```
